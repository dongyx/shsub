.TH shsub 1

.SH NAME

shsub - substitute embedded shell commands and expressions with their
outputs and results

.SH SYNOPSIS

\fBshsub\fR [\fIoptions\fR] [\fIfile\fR\]

.SH DESCRIPTION

.PP
A shell template is text
with shell commands and expressions embedded in.

.PP
The shell commands are surrounded by \fB<%\fR and \fB%>\fR.

.PP
Each \fB<%\fIcmd\fB%>\fR is substituted
with the output of the command.

.PP
Ordinary text is converted to the command printing that text,
then the command is substituted by its output.
Thus control structure can be used in shell commands.

.PP
The shell expressions are surrounded by \fB<%=\fR and \fB%>\fR.

.PP
Each \fB<%=\fIexpr\fB%>\fR is substituted with
the output of the command \fBprintf %s \[dq]\fIexpr\fB\[dq]\fR.
Double quotes in \fIexpr\fR are automatically escaped by \fBshsub\fR.

.PP
\fB<%%\fR and \fB%%>\fR are escape tokens representing
literal \fB<%\fR and \fB%>\fR.

.PP
If \fB-%>\fR is used instead of \fB%>\fR,
\fBshsub\fR deletes the last newline of the output if there is one.
\fB-%>\fR pipes the output of the command to a program
deleting the potential newline.
Thus the command must be in a limited form that can be
succeeded by a pipe.

.PP
\fBshsub\fR reads the shell template from \fIfile\fR,
and prints the result to stdout.
If \fIfile\fR is omitted, read from stdin.

.SH CAVEATS

When \fBshsub\fR reads from stdin,
and the shell template contains commands reading from stdin,
e.g. \fBread\fR(1), the behavior is unspecific.

.SH OPTIONS

.TP
\fB\-s\fR \fIshell\fR
Set which shell is used.
By default,
\fBshsub\fR uses \fB/bin/sh\fR.

.TP
.B \-h
Print the brief usage.

.TP
.B \-v
Print the version information.
